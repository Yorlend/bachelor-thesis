\chapter{Конструкторский раздел}

В данном разделе разработан метод опорных точек сигнала для геопозиционирования в помещениях с помощью Wi-Fi. Описаны особенности предлагаемого метода, ключевые этапы и требования к формату входных и выходных данных для работы метода. В конце раздела описаны структуры данных, используемые в алгоритмах.

\section{Функциональная модель метода}

На рисунке \ref{img:idef0-1} представлена функциональная модель метода опорных точек сигналов для геопозиционирования в помещении с помощью WiFi. Метод основан на анализе уровней сигналов опорных точек и агента, а также градиентов уровней сигналов в опорных точках.

\includeimage
    {idef0-1}
    {f}
    {H}
    {\linewidth}
    {Функциональная модель метода}

\section{Структуры данных}

В ходе реализации проектируемого метода предлагается использовать следующие структуры данных:

\begin{itemize}[label=---]
    \item матрица опорных точек, содержащая координаты опорных точек;
    \item матрица уровней сигналов опорных точек;
    \item матрица градиентов уровней сигналов опорных точек;
    \item вектор уровней сигналов агента;
    \item список вершин многоугольника, определяющего границу помещения.
\end{itemize}

\section{Схемы алгоритмов}

\subsection{Алгоритм вычисления градиента в опорной точке}

В контексте разрабатываемого метода необходимо вычислять градиент вектор-функции от двух переменных --- координат опорной точки. Введем следующие обозначения:

\begin{itemize}[label=---]
    \item $(x_i, y_i)$ --- координаты i-ой опорной точки;
    \item $RSSI_i$ --- вектор уровней сигналов в i-ой опорной точке;
    \item $f: \mathbb{R}^2 \rightarrow \mathbb{R}^N$ --- функция, сопоставляющая каждой точке пространства вектор уровней сигналов, где $N$ --- количество роутеров,
\end{itemize}
тогда функция $f$ в окрестности опорной точки может быть аппроксимирована следующим образом:

\begin{equation}
    f(\vec{x}) \approx f(\vec{x}_0) + \Delta \vec{x} \otimes \vec{\nabla} f(\vec{x}_0).
    \label{eq:f-approx}
\end{equation}
Из приведенной в формуле (\ref{eq:f-approx}) аппроксимации составляется уравнение линейной регрессии:

\begin{equation}
    Y = XB,
    \label{eq:lr}
\end{equation}
где $Y = f(\vec{x}) - f (\vec{x}_0)$, $X = \Delta \vec{x}$, а $B = \vec{\nabla} f(\vec{x}_0)$. В уравнении (\ref{eq:lr}) матрица $B$ может быть найдена методом наименьших квадратов.

\begin{equation}
    B = (X^TX)^{-1}X^TY.
    \label{eq:lr-b}
\end{equation}

Для расчета градиента уровней сигналов в опорной точке осуществляется поиск двух ближайших опорных точек, алгоритм выбора которых представлен на рисунке \ref{img:rp-select}.

\includeimage
    {rp-select}
    {f}
    {H}
    {0.7\linewidth}
    {Алгоритм выбора пары ближайших опорных точек}

После выбора пары ближайших опорных точек, составляются матрицы $X$ и $Y$, и решается уравнение (\ref{eq:lr-b}). Значения, полученные в матрице $B$ являются приблежением градиента уровней сигналов в заданной опорной точке.

\subsection{Алгоритм определения позиции агента}

На рисунке \ref{img:alg} представлена схема алгоритма поиска позиции агента в помещении.

\includeimage
    {alg}
    {f}
    {H}
    {0.5\linewidth}
    {Алгоритм определения позиции агента в помещении}

\subsection{Алгоритм поиска оптимального положения опорных точек}

\textbf{TODO}

\section{Требования к ПО}

К разрабатываемому ПО предъявляются следующие требования:

\begin{itemize}[label=---]
    \item пользователь должен иметь возможность редактировать количество и положение опорных точек;
    \item пользователь должен иметь возможность редактировать количество и положение точек доступа;
    \item пользователь должен иметь возможность перемещать агента по помещению;
    \item предусмотреть возможность изменения топологии помещения;
    \item предусмотреть возможность оптимальной расстановки опорных точек в помещении по запросу пользователя.
\end{itemize}

К входным данным предъявляются следующие ограничения:

\begin{itemize}[label=---]
    \item количество опорных точек должно быть больше трех;
    \item опорные точки не должны лежать на одной линии;
    \item количество точек доступа должно быть больше двух.
\end{itemize}

\section{Архитектура ПО}

Программное обеспечение, разрабатываемое в работе, представлено в виде клиент-серверного приложения. Серверная часть разрабатывается независимо от клиентской, предоставляя API для вызовов необходимых пользователю функций. Клиентская часть представлена в виде SPA-приложения. (дополнить, причесать)

...
